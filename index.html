<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project4: Neural Radiance Field</title>
  <style>
    body {
      background-color: #D8C3DD; /* 紫色背景 */
      font-family: Arial, sans-serif;
      color: white;
      margin: 0;
      padding: 0;
    }

    /* 导航栏 */
    nav {
      background: rgba(0, 0, 0, 0.3);
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    nav a {
      color: #ffddff;
      text-decoration: none;
      margin: 0 15px;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
    }

    .container {
      width: 80%;
      margin: auto;
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-top: 20px;
    }

    .section {
      background: rgba(0,0,0,0.2);
      padding: 20px;
      margin: 40px 0;
      border-radius: 12px;
    }

    .section h2 {
      color: #ffddff;
      text-align: center;
      margin-top: 0;
    }

    p {
      text-align: left;
      max-width: 1000px;
      margin: auto;
      margin-bottom: 20px;
      font-size: 18px;
      color: white;
    }

    hr {
      border: none;
      border-top: 1px solid rgba(255,255,255,0.12);
      margin: 30px 0;
    }

    /* 图片排版 */
    .two-images {
      display: flex;
      justify-content: center;
      gap: 48px;
      margin-top: 30px;
      flex-wrap: wrap;
    }
    .img-block {
      flex: 0 0 320px;
      text-align: center;
    }
    .img-block img {
      width: 400px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    .img-block p {
      margin-top: 8px;
      font-size: 16px;
      color: white;
      text-align: center;
    }

    /* 小屏幕适配 */
    @media (max-width: 760px) {
      .container { width: 92%; padding: 12px; }
      .img-block { flex: 0 0 45%; }
      .img-block img { width: 100%; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<nav>
  <a href="#part0">Part0</a>
  <a href="#part1">Part1</a>
  <a href="#part2">Part2</a>
</nav>

<div class="container">
  <h1>Project4: Neural Radiance Field</h1>

  <!-- =========================== -->
  <!-- Part 0 -->
  <!-- =========================== -->
  <div class="section" id="part0">
    <h2>Part 0: Camera Calibration & 3D Scan</h2>

    <h3>Part 0.1: Calibrating My Camera</h3>
    <p>
      I first captured 33 calibration images with multiple ArUco markers. Using OpenCV, I extracted 2D-3D correspondences and estimated the intrinsic matrix and distortion coefficients.
    </p>

    <h3>Part 0.2: Capturing the 3D Scan</h3>
    <p>
      I took 34 pictures of the bottle from many viewpoints.  
      <img src="bottle1.JPG" width="250" style="margin-right: 20px;">
      <img src="bottle2.JPG" width="250">
    </p>

    <h3>Part 0.3: Estimating Camera Pose</h3>
    <p>
      Using ArUco markers and solvePnP, I computed rotation and translation matrices for each image. 
      The results are visualized below.
    </p>
    <div class="two-images">
      <div class="img-block">
        <img src="pose1.jpg" alt="Pose Visualization 1">
        <p>Estimated Pose (Example 1)</p>
      </div>
      <div class="img-block">
        <img src="pose2.jpg" alt="Pose Visualization 2">
        <p>Estimated Pose (Example 2)</p>
      </div>
    </div>

    <h3>Part 0.4: Undistorting Images and Building Dataset</h3>
    <p>
      All images are undistorted using the calibration parameters and organized with camera intrinsics and c2w poses into a structured dataset.
    </p>
  </div>

  <!-- =========================== -->
  <!-- Part 1 -->
  <!-- =========================== -->
  <div class="section" id="part1">
    <h2>Part 1: Fit a Neural Field to a 2D Image</h2>
    <p>
      The network maps 2D pixel coordinates to RGB. Positional encoding expands the 2D input for high-frequency details. A 4-layer MLP predicts RGB.
    </p>
    <div class="two-images">
      <div class="img-block">
        <img src="fox200.png" alt="Iteration 200">
        <p>Iteration 200</p>
      </div>
      <div class="img-block">
        <img src="fox800.png" alt="Iteration 800">
        <p>Iteration 800</p>
      </div>
      <div class="img-block">
        <img src="fox1400.png" alt="Iteration 1400">
        <p>Iteration 1400</p>
      </div>
      <div class="img-block">
        <img src="fox2000.png" alt="Iteration 2000">
        <p>Iteration 2000</p>
      </div>
    </div>
    <p style="text-align:center;">PSNR Curve:</p>
    <div class="img-block" style="margin:auto;">
      <img src="yifeipsnr_curve.png" alt="PSNR Curve" width="500">
      <p>PSNR over Training Iterations</p>
    </div>
  </div>

  <!-- =========================== -->
  <!-- Part 2 -->
  <!-- =========================== -->
  <div class="section" id="part2">
    <h2>Part 2: Fit a Neural Radiance Field from Multi-view Images</h2>

    <h3>2.1: Create Rays from Cameras</h3>
    <p>
      Transform world coordinates to camera coordinates and project pixels to rays.
    </p>
    <p style="text-align:center;">$$\mathbf{x}(t) = \mathbf{r}_o + t \mathbf{r}_d$$</p>

    <h3>2.2: Sampling Points</h3>
    <p>Sample points along rays between near and far bounds.</p>

    <h3>2.3: Dataloader</h3>
    <p>
      Rays and RGB are organized in a dataloader. Sample rays can be visualized below.
    </p>
    <div class="two-images">
      <div class="img-block">
        <img src="random_100_rays.png" alt="Random 100 Rays">
        <p>Random 100 Rays</p>
      </div>
      <div class="img-block">
        <img src="single_camera_100_rays.png" alt="100 Rays from One Camera">
        <p>100 Rays from One Camera</p>
      </div>
    </div>

    <h3>2.4: NeRF Architecture</h3>
    <p>
      Network predicts density and RGB. Positional encoding applied. Skip connections used.
    </p>
    <div style="text-align:center;">
      <img src="intronerf.png" alt="NeRF MLP" width="700">
    </div>

    <h3>2.5: Volume Rendering</h3>
    <p>Compute color along rays using discrete volume rendering.</p>
    <div class="two-images">
      <div class="img-block">
        <img src="legoPSNR.png" alt="Validation PSNR Curve" width="400">
        <p>Validation PSNR Curve</p>
      </div>
      <div class="img-block">
        <img src="legoloss.png" alt="Training Loss Curve" width="400">
        <p>Training Loss Curve</p>
      </div>
    </div>
    <div style="text-align:center; margin-top:20px;">
      <img src="loopedle.gif" alt="Spherical Render" width="400">
      <p>Final Rendering (Orbit View)</p>
    </div>

    <h3>2.6: Training with Your Own Data</h3>
    <p style="text-align:justify;">
      5000 iterations, 10,000 rays per iteration, 64 points per ray. Width 256 MLP, PE levels 10 for xyz and 4 for view direction. Adam optimizer 5×10⁻⁴.
    </p>
    <div class="two-images">
      <div class="img-block"><img src="bottle1000.png" alt="Iteration 1000"><p>Iteration 1000</p></div>
      <div class="img-block"><img src="bottle2000.png" alt="Iteration 2000"><p>Iteration 2000</p></div>
      <div class="img-block"><img src="bottle3000.png" alt="Iteration 3000"><p>Iteration 3000</p></div>
      <div class="img-block"><img src="bottle4000.png" alt="Iteration 4000"><p>Iteration 4000</p></div>
      <div class="img-block"><img src="bottle5000.png" alt="Iteration 5000"><p>Iteration 5000 (Final)</p></div>
    </div>
    <div class="two-images" style="gap:30px; margin-top:20px;">
      <div class="img-block"><img src="bottlepsnr.png" alt="Validation PSNR" width="340"><p>Validation PSNR Curve</p></div>
      <div class="img-block"><img src="bottleloss.png" alt="Training Loss" width="400"><p>Training Loss Curve</p></div>
    </div>
    <div style="text-align:center; margin-top:30px;">
      <img src="bottle.gif" alt="Final Rendering Orbit" width="400">
      <p>Final Rendering (Orbit View)</p>
    </div>
  </div>
</div>

</body>
</html>
